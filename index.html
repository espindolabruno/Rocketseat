<html>
    <head>
        <title>Macacomanco</title>
    </head>

<body>

    <div id="teste">
        
    </div>

    <button class="botao">Me clique aqui!</button>

        <script>
            var margem = 0, margemAnterior = 0, margemLeft =0;
            var teste = 0;
            var btnElement = document.querySelector('button.botao');
            
                btnElement.onclick = function ()
                {
                            
                    var quadrado = document.createElement('div');
                    quadrado.className = 'quadrado'+teste;
                    quadrado.style.width = 100;
                    quadrado.style.height = 100;
                    quadrado.style.backgroundColor = '#F00'; 
                    quadrado.style.marginLeft = margemLeft;  
                    quadrado.style.marginTop = margemAnterior - margem;             
                    quadrado.setAttribute('onmouseover', 'aplicacor(className)');

                    var containerElement = document.querySelector('#teste');
                    containerElement.appendChild(quadrado);

                margemAnterior = margem;          
                margem = margem + 100;    
                margemLeft = margemLeft +100;
                
                    if (margemLeft === 1300){
                        margem = 0;
                        margemAnterior = 0;
                        margemLeft = 0;
                    }   
                teste ++;
                }
        
            function getRandomColor() 
            {
                
                var letters = "0123456789ABCDEF";
                var color = "#";
                for (var i = 0; i < 6; i++) 
                {
                    color += letters[Math.floor(Math.random() * 16)];
                    }    
                return color;

            }
        
            

            function aplicacor(classe)
            {
                getRandomColor; 
                var newColor = getRandomColor(); // #E943F0   
                classId = document.className;
                document.querySelector('div.'+classe).style.backgroundColor = newColor; 
            }
       
        </script>
</body>
</html>